---
interface Props {
  message?: string;
  duration?: number;
  link?: string;
}

const { 
  message = "Check out our latest film projects!",
  duration = 5000,
  link = "/projects"
} = Astro.props;
---

<div
  class="announcement-banner fixed top-[70px] md:top-[115px] right-0 w-full z-[99] transform transition-all duration-1000 ease-out -translate-y-full opacity-0 bg-white"
  data-duration={duration}
>
  <div class="bg-white p-2 sm:p-4 flex justify-center items-center shadow-lg relative">
    <div class="flex-1 text-center">
      {link ? (
        <a 
          href={link}
          class="announcement-link text-gray-800 text-sm sm:text-base font-semibold hover:text-gray-900 transition-all duration-200 inline-flex items-center gap-2 group cursor-pointer hover:underline decoration-2 underline-offset-2"
        >
          {message}
          <svg
            class="w-4 h-4 sm:w-5 sm:h-5 transform transition-transform group-hover:translate-x-1"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M13 7l5 5m0 0l-5 5m5-5H6"
            />
          </svg>
        </a>
      ) : (
        <p class="text-gray-800 text-sm sm:text-base font-medium">
          {message}
        </p>
      )}
    </div>
    <button
      class="announcement-close absolute right-4 text-gray-700 hover:text-gray-900 transition-colors flex-shrink-0"
      aria-label="Close announcement"
      type="button"
    >
      <svg
        class="w-5 h-5 sm:w-6 sm:h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>
    </button>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const banner = document.querySelector('.announcement-banner');
    const closeBtn = document.querySelector('.announcement-close');
    const duration = parseInt(banner?.getAttribute('data-duration') || '5000');

    if (banner) {
      // Remove banner-hidden class when banner is shown
      document.body.classList.remove('banner-hidden');

      // Trigger slide-in animation on load
      setTimeout(() => {
        banner.classList.remove('-translate-y-full', 'opacity-0');
        banner.classList.add('translate-y-0', 'opacity-100');
      }, 100);


      // Close button handler
      closeBtn?.addEventListener('click', () => {
        banner.classList.remove('translate-y-0', 'opacity-100');
        banner.classList.add('-translate-y-full', 'opacity-0');
        document.body.classList.add('banner-hidden');
      });
    } else {
      // If banner doesn't exist, add the class
      document.body.classList.add('banner-hidden');
    }
  });
</script>

<style>
  .announcement-link {
    outline: 2px dashed transparent;
    outline-offset: 2px;
  }

  .announcement-link:hover {
    outline-color: currentColor;
  }

  .announcement-link:focus {
    outline: 2px solid currentColor;
  }
</style>
