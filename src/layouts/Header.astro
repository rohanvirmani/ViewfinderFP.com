---
// Add a boolean to track mobile menu state
---
<header class="bg-[#c2b1d2] p-4 md:px-8 fixed top-0 right-0 w-full z-50 flex justify-between items-center">
  <img 
    src="/images/VFP Monogram - Black.png" 
    alt="Company Logo" 
    class="h-auto w-[100px] md:w-[130px] object-contain ml-4 md:ml-[40px]" 
  />
  
  <!-- Mobile menu button -->
  <button 
    id="mobile-menu-button" 
    class="md:hidden p-2 text-[#0f0000] hover:text-gray-300"
    aria-label="Toggle menu"
  >
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
  </button>

  <!-- Navigation menu -->
  <nav id="nav-menu" class="fixed md:relative top-[72px] md:top-0 right-0 w-full md:w-auto bg-[#c2b1d2] md:bg-transparent transform translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out md:transition-none">
    <div class="flex flex-col md:flex-row justify-end gap-4 md:gap-8 items-center p-4 md:p-0">
      <a href="/#home-page" data-target="home-page" class="nav-link text-[#0f0000] no-underline text-lg font-medium transition-colors duration-300 ease-in-out hover:text-gray-300 w-full md:w-auto text-center py-2 md:py-0">Home</a>
      <a href="/#about-us-page" data-target="about-us-page" class="nav-link text-[#0f0000] no-underline text-lg font-medium transition-colors duration-300 ease-in-out hover:text-gray-300 w-full md:w-auto text-center py-2 md:py-0">About Us</a>
      <a href="/#projects-page" data-target="projects-page" class="nav-link text-[#0f0000] no-underline text-lg font-medium transition-colors duration-300 ease-in-out hover:text-gray-300 w-full md:w-auto text-center py-2 md:py-0">Film Projects</a>
      <a href="/#contact-us-page" data-target="contact-us-page" class="nav-link text-[#0f0000] no-underline text-lg font-medium transition-colors duration-300 ease-in-out hover:text-gray-300 w-full md:w-auto text-center py-2 md:py-0">Contact Us</a>
    </div>
  </nav>
</header>

<script>
  // Mobile menu functionality
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const navMenu = document.getElementById('nav-menu');
  let isMenuOpen = false;

  if (mobileMenuButton && navMenu) {
    mobileMenuButton.addEventListener('click', () => {
      isMenuOpen = !isMenuOpen;
      navMenu.style.transform = isMenuOpen ? 'translateX(0)' : 'translateX(100%)';
    });
  }

  // A robust script to wait for the Swiper instance
  const swiperEl = document.getElementById('main-swiper');
  const navLinks = document.querySelectorAll('[data-target]');
  
  if (swiperEl) {
    const checkSwiper = () => {
      const swiperInstance = (swiperEl as any).swiper;
      
      if (swiperInstance) {
        navLinks.forEach(link => {
          link.addEventListener('click', (event) => {
            event.preventDefault(); 
            const targetHash = link.getAttribute('data-target');
            
            // Close mobile menu when a link is clicked
            if (window.innerWidth < 768) {
              isMenuOpen = false;
              navMenu.style.transform = 'translateX(100%)';
            }

            let slideIndex = -1;
            swiperInstance.slides.forEach((slide: { dataset: { hash: string | null; }; }, index: number) => {
              if (slide.dataset.hash === targetHash) {
                slideIndex = index;
              }
            });

            if (slideIndex !== -1) {
              swiperInstance.slideTo(slideIndex);
            }
          });
        });
      } else {
        setTimeout(checkSwiper, 50);
      }
    };
    
    checkSwiper();
  }

  // Close menu when clicking outside
  document.addEventListener('click', (event) => {
    if (isMenuOpen && navMenu && !navMenu.contains(event.target as Node) && !mobileMenuButton.contains(event.target as Node)) {
      isMenuOpen = false;
      navMenu.style.transform = 'translateX(100%)';
    }
  });

  // Handle resize events
  window.addEventListener('resize', () => {
    if (window.innerWidth >= 768 && navMenu) {
      navMenu.style.transform = 'translateX(0)';
      isMenuOpen = false;
    }
  });
</script>
