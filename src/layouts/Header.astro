---
import DesktopHeader from './DesktopHeader.astro';
import MobileHeader from './MobileHeader.astro';
---

<div id="desktop-header">
  <DesktopHeader />
</div>

<div id="mobile-header">
  <MobileHeader />
</div>

<script is:inline>
  // Move JavaScript to client-side only
  function isMobileDevice() {
    return window.innerWidth < 768 || 'ontouchstart' in window || navigator.maxTouchPoints > 0;
  }

  function updateHeaderVisibility() {
    const desktopHeader = document.getElementById('desktop-header');
    const mobileHeader = document.getElementById('mobile-header');
    
    if (!desktopHeader || !mobileHeader) {
      console.warn('Header elements not found. Desktop:', !!desktopHeader, 'Mobile:', !!mobileHeader);
      return;
    }

    const isMobile = isMobileDevice();
    
    try {
      desktopHeader.style.display = isMobile ? 'none' : 'block';
      mobileHeader.style.display = isMobile ? 'block' : 'none';
    } catch (error) {
      console.error('Error updating header visibility:', error);
    }
  }

  // Initialize after DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', updateHeaderVisibility);
  } else {
    updateHeaderVisibility();
  }

  // Handle resize events with debouncing
  let resizeTimer;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(updateHeaderVisibility, 250);
  });
</script>

<style>
  /* Mobile menu page styles */
  #mobile-menu-page {
    -webkit-overflow-scrolling: touch;
  }

  .mobile-nav-link {
    -webkit-tap-highlight-color: transparent;
    transition: transform 0.2s ease;
  }

  .mobile-nav-link:active {
    transform: scale(0.98);
  }

  /* Touch event handling */
  #mobile-menu-button,
  #close-menu-button {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  /* Active states for buttons */
  #mobile-menu-button:active,
  #close-menu-button:active {
    background-color: rgba(0, 0, 0, 0.1);
  }

  /* Link animations */
  @media (hover: hover) {
    .mobile-nav-link:hover span span {
      width: 100%;
    }
  }

  /* Prevent scrolling when menu is open */
  body.menu-open {
    overflow: hidden;
    position: fixed;
    width: 100%;
  }
</style>